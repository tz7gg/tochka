{"version":3,"sources":["getUser.js","instruction.js","purchaseProduct.js","render.js","search.js","spinner.js"],"names":["USERLINK","concat","window","location","href","getUser","userLogin","url","fetch","then","res","instructionBtn","document","querySelector","instructionWrap","instructionClose","PURCHASELINK","onclick","classList","add","remove","purchaseProduct","userId","productId","render","data","coins","productsWrap","content","innerText","innerHTML","products","forEach","element","imgSrc","description","includes","id","price","slice","orders","el","item","product_id","querySelectorAll","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","parentNode","dataset","spinner","userInfo","json","sent","stop","searchInput","searchBtn","exchangeError","balanceWrap","options","active","addEventListener","value"],"mappings":"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","file":"main.min.js","sourcesContent":["const USERLINK = `${window.location.href}/API/getUser.php`\r\n\r\nfunction getUser(userLogin) {\r\n    const url = `${USERLINK}?user=${userLogin}`\r\n    return fetch(url).then(res => res)\r\n}","const instructionBtn = document.querySelector('.exchanger__options__instruction-btn')\r\nconst instructionWrap = document.querySelector('.instruction')\r\nconst instructionClose = document.querySelector('.instruction__wrap__close')\r\n\r\ninstructionBtn.onclick = () => {\r\n    instructionWrap.classList.add('active')\r\n}\r\n\r\ninstructionClose.onclick = () => {\r\n    instructionWrap.classList.remove('active')\r\n}","const PURCHASELINK = `${window.location.href}/API/purchase.php`\r\n\r\nfunction purchaseProduct(userId, productId) {\r\n    const url = `${PURCHASELINK}?userid=${userId}&productid=${productId}`\r\n    return fetch(url).then(res => res)\r\n}","function render(data) {\r\n    const coins = document.querySelector('.exchanger__balance__count__text')\r\n    const productsWrap = document.querySelector('.exchanger__options__items')\r\n    let content = ''\r\n\r\n    coins.innerText = data.coins\r\n    productsWrap.innerHTML = ''\r\n\r\n    data.products.forEach(element => {\r\n        let imgSrc\r\n\r\n        if (element.description.includes('звонки')) {\r\n            imgSrc = 'images/tel.svg'\r\n        } else if (element.description.includes(' спецкурс')) {\r\n            imgSrc = 'images/book.svg'\r\n        } else if (element.description.includes('курс')) {\r\n            imgSrc = 'images/books.svg'\r\n        }\r\n\r\n        content += `\r\n\t\t\t\t<div class=\"exchanger__options__items__item\" data-id=${element.id}>\r\n\t\t\t\t<div class=\"exchanger__options__items__item__price\">\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__price__icon\">\r\n\t\t\t\t\t\t<img src=\"images/coin.svg\" alt=\"\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__price__text\">${element.price}</div>\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__price__currency\">\r\n\t\t\t\t\t\t<img src=\"images/currency.svg\" alt=\"\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"exchanger__options__items__item__icon\">\r\n\t\t\t\t\t<img src=${imgSrc} alt=\"\">\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"exchanger__options__items__item__des\">\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__des__badge\">${element.description.slice(0, 3)}</div>\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__des__text\">${element.description.slice(3)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"exchanger__options__items__item__btn ${data.coins < element.price ? 'disabled' : ''}\">\r\n\t\t\t\t\t<div class=\"exchanger__options__items__item__btn__text\">${data.coins < element.price ? 'Недостаточно средств' : 'Использовать скидку'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`\r\n    });\r\n    productsWrap.innerHTML = content\r\n    isOrder(data)\r\n    addPurchaseHandler()\r\n\r\n    function isOrder(data) {\r\n        data.orders.forEach((el) => {\r\n            let item = document.querySelector(`[data-id='${el.product_id}']`)\r\n            item.querySelector('.exchanger__options__items__item__btn').classList.add('active')\r\n            item.querySelector('.exchanger__options__items__item__btn__text').innerText = 'Уже использованно'\r\n        })\r\n    }\r\n\r\n    function addPurchaseHandler() {\r\n        const items = document.querySelectorAll('.exchanger__options__items__item__btn')\r\n        items.forEach(function(item) {\r\n            item.onclick = async() => {\r\n                const productId = item.parentNode.dataset.id\r\n                spinner(true)\r\n                let data = await purchaseProduct(userInfo.id, productId).then(res => res.json())\r\n                document.querySelector('.exchanger__balance__count__text').innerText = data.coins\r\n                item.querySelector('.exchanger__options__items__item__btn__text').innerText = \"Уже использованно\"\r\n                item.classList.add('active')\r\n                spinner(false)\r\n            }\r\n        })\r\n    }\r\n}","const searchInput = document.querySelector('.search__input')\r\nconst searchBtn = document.querySelector('.search__btn')\r\nconst exchangeError = document.querySelector('.exchanger__error')\r\nconst balanceWrap = document.querySelector('.exchanger__balance')\r\nconst options = document.querySelector('.exchanger__options')\r\n\r\nwindow.addEventListener('load', () => {\r\n    searchBtn.onclick = async() => {\r\n        if (searchInput.value) {\r\n            spinner(true)\r\n            let data = await getUser(searchInput.value).then(res => res.json())\r\n            if (data.id === 0) {\r\n                exchangeError.innerText = 'Пользователь не найден!'\r\n                exchangeError.classList.remove('dn')\r\n                balanceWrap.classList.add('dn')\r\n                options.classList.add('dn')\r\n            } else {\r\n                exchangeError.classList.add('dn')\r\n                balanceWrap.classList.remove('dn')\r\n                options.classList.remove('dn')\r\n                render(userInfo)\r\n            }\r\n            spinner(false)\r\n        }\r\n    }\r\n})","function spinner(active) {\r\n    const spinner = document.querySelector('.spinner-conteiner')\r\n    if (active) {\r\n        spinner.classList.add('active')\r\n    } else {\r\n        spinner.classList.remove('active')\r\n    }\r\n}"]}